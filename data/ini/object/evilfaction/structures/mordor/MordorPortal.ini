;------------------------------------------------------------------------------
Object MordorHellPortalEgg
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None 
		End
		ModelConditionState = WORLD_BUILDER
			Model = MULrkr_SKN
		End
	End

	Side = EvilBeasts
	EditorSorting = UNIT

	KindOf = INERT IMMOBILE UNATTACKABLE NOT_AUTOACQUIRABLE

	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay = 10	
		OCL = INITIAL OCL_HellPortal
	End
End
 ;------------------------------------------------------------------------------
Object MordorHellPortal
	Draw = W3DScriptedModelDraw ModuleTag_Draw

		//RandomTexture	= emhellwater_.tga 0  gbwell_waterb.tga	//tswater.tga

		DefaultModelConditionState
			Model = EXCauldera_SKN
			ParticleSysBone = None HellPortalMist1
			ParticleSysBone = None HellPortalMainMist 
			ParticleSysBone = None HellPortalMainMist2
			ParticleSysBone = None HellPortalFire1
			ParticleSysBone = None HellPortalFire2
			ParticleSysBone = None HellPortalFire3
			ParticleSysBone = None MordorPortalCracks
		//FXEvent	= Frame:24 Name: FX_MordorPortalQuake
		End
		
		IdleAnimationState
			Animation = JustHangOut
				AnimationName = EXCauldera_SKL.EXCauldera_IDLA
				AnimationMode = MANUAL
			End
			Flags = START_FRAME_LAST 
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_JustBuilt" 
					then CurDrawableSetTransitionAnimState("TRANS_JustBuilt_To_Idle") 
				end
			EndScript
		End
		
		AnimationState			= JUST_BUILT
			StateName = State_JustBuilt
			Animation
				AnimationName = EXCauldera_SKL.EXCauldera_SPA
				AnimationMode = MANUAL
				AnimationBlendTime = 0
			End
		End
		
	    TransitionState = TRANS_JustBuilt_To_Idle
			Animation = BeingSummoned
				AnimationName = EXCauldera_SKL.EXCauldera_SPA 
				AnimationMode = ONCE
			End
		End

		AnimationState					=	DYING DEATH_1
			Animation					=	Dying 
				AnimationName			=	EXCauldera_SKL.EXCauldera_DIE 
				AnimationMode			=	ONCE
			End
		End

		AnimationState					=	DYING DEATH_2
			Animation					=	FadingOut 
				AnimationName			=	EXCauldera_SKL.EXCauldera_DIE 
				AnimationMode			=	ONCE
			End
		End
	End

	;// ***DESIGN parameters ***
	DisplayName         	= EVILMOD:MordorHellPortal
	Description 	      	= EVILMOD:MordorHellPortalDes
	Side                	= Mordor
	EditorSorting       	= STRUCTURE
	ThreatLevel				= 1.0
	 
	BuildCost           	= EVILMOD_PORTAL_COST
	BuildTime           	= 60           ;// in seconds
	BountyValue				= 150
	VisionRange         	= ISENGARD_WARG_SENTRY_VISIONRANGE          ;// Shroud clearing distance
	ShroudClearingRange 	= ISENGARD_WARG_SENTRY_SHROUDCLEAR

	CommandSet				= MordorPortalCommandSet
	
	ArmorSet
		Conditions        = None
		Armor             = PortalsArmor
	End

	;// *** AUDIO Parameters ***
	#include "..\..\..\includes\StandardBuildingEvaEvents.inc"

	SoundAmbient			= HellPortalAmbience

	EditorSorting = SYSTEM
	RadarPriority       = STRUCTURE
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE FS_FACTORY NEED_BASE_FOUNDATION CASTLE_KEEP //MADE_OF_WOOD
		
	//Body = HighlanderBody ModuleTag_Body
	//	MaxHealth = 1
	//End
		
	Behavior = AIUpdateInterface ModuleTag_OK
	AILuaEventsList	= TotemOrcTrolololFunctions
  	End
	 
	Behavior            = GettingBuiltBehavior ModuleTag_04
		WorkerName					= MordorWorkerNoSelect
		SelfBuildingLoop			= BuildingConstructionLoop	// Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop	= NoSound					// This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop	= BuildingConstructionLoop
		SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
	End

	Body                = StructureBody ModuleTag_05
		MaxHealth               = 22000
		MaxHealthDamaged        = 1500
		MaxHealthReallyDamaged  = 800
	End

	
	Behavior = KeepObjectDie ModuleTag_IWantRubble
	End

	Behavior                  = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate 
		MinCollapseDelay        = 000
		MaxCollapseDelay        = 000
		CollapseDamping         = .5
		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
		FXList                  = INITIAL   FX_StructureMediumCollapse
		FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
		DestroyObjectWhenDone	= Yes
		CollapseHeight			= 0
	End

	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
		FireWeaponNugget
			WeaponName = MordorPortalWeapon	
			Offset = X:0 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End


	Behavior = QueueProductionExitUpdate ModuleTag_11
	   	UnitCreatePoint		= X:0.0 Y:0.0 Z:0.0
		NaturalRallyPoint	= X:0.0 Y:0.0 Z:0.0
		ExitDelay			= 300 ; Mainly for the multiple produced Red Guard.  Make them come out one at a time.
	End
		
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = No
	End

	Behavior = TerrainResourceBehavior ModuleTag_NewMoneyDeadSpot
		Radius			= 60		// How far we try to claim ground
		MaxIncome		= 0			// If we were to get all we wanted, how much we would earn.  Linear slope to 0 at 0% claim
		IncomeInterval	= 999999	// How often (in msec) we give that much money
		HighPriority	= Yes		// A high priority claim gets to pretend it was there first.
		Visible = No 		;// Don't show decal when a resource building is selected.
	End

  	Behavior = SlowDeathBehavior ModuleTag_NormalDeath
		DeathTypes = ALL -FADED
		DestructionDelay = 2500
        DeathFlags = DEATH_1
	End
  
	;Behavior      = SpawnUnitBehavior ModuleTag_allowMeToBuildDrakeFromCitadel
	;	UnitName		= ElvenFortressEagle		
	; End	

  	Behavior = SlowDeathBehavior ModuleTag_FadeDeath
		DeathTypes = NONE +FADED
		DestructionDelay = 3800
        DeathFlags = DEATH_2
	End
	
	//Behavior = AttachUpdate ModuleTag_AttachToHead
	//	ObjectFilter	= NONE +WatcherHead
	//	ScanRange		= 100
	//End
	

	MaxSimultaneousOfType		= 1
  
End

;------------------------------------------------------------------------------
Object MordorPorterTotem
	
	SelectPortrait = BPGCamp_Plot

	Draw = W3DScriptedModelDraw ModuleTag_Draw
	
		DefaultModelConditionState
			Model               = WUGobKng_Totem
			ParticleSysBone = None TaintHCPing HouseColor:yes
			ParticleSysBone = None GoblinKingTaint
			

				Shadow =  SHADOW_ALPHA_DECAL_DYNAMIC; SHADOW_ADDITIVE_DECAL_DYNAMIC
				ShadowSizeX = 200;
				ShadowSizeY = 200;
				ShadowTexture = EXTaint;
				
				ShadowOpacityStart = 0
				ShadowOpacityFadeInTime = 1000
				ShadowOpacityPeak = 175
				ShadowOpacityFadeOutTime = 1000
				ShadowOpacityEnd = 0
				ShadowOverrideLODVisibility = YES
		End
		
	

	End

	; ***DESIGN parameters ***
	DisplayName			= EVILMOD:PortalTotem
	Description 	      		= EVILMOD:PortalTotemDes
	EditorSorting		= MISC_MAN_MADE
	Side				= Mordor
	ShroudClearingRange	= SHROUD_CLEAR_SKULL_TOTEM
	;KindOf				= STRUCTURE IMMOBILE SELECTABLE IGNORE_FOR_VICTORY ;NOT_AUTOACQUIRABLE
	;Shadow				= SHADOW_VOLUME
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE FS_FACTORY NEED_BASE_FOUNDATION CASTLE_KEEP
	RadarPriority		= STRUCTURE
	
	Body            = ActiveBody ModuleTag_Body
		MaxHealth	= SKULL_TOTEM_HEALTH
		//RemoveUpgradesOnDeath = Upgrade_OrcTrollFaceOK
	End

	Behavior = DestroyDie ModuleTagDeath_Die
		DeathTypes = ALL
	End

	Behavior = UpgradeDie  UpgradeDieModuleTag
    	DeathTypes = ALL
    	UpgradeToRemove     = Upgrade_OrcTrollFaceOK
	End
  

	Behavior = StealthDetectorUpdate ModuleTag_DetectStealth
		DetectionRate	= SKULL_TOTEM_STEALTH_DETECT_RATE			; how often to rescan for stealthed things in my sight (msec)
		DetectionRange	= SKULL_TOTEM_STEALTH_DETECT_RADIUS			; enable this for independant balancing!
	End

	Behavior = GrantUpgradeCreate ModuleTag_GiveUpgrade
		UpgradeToGrant		= Upgrade_OrcTrollFaceOK
		GiveOnBuildComplete = Yes
	End
	
	CommandSet	= SellCommandSet

	Geometry				= CYLINDER
  	GeometryMajorRadius		= 5.0
	GeometryHeight			= 20.0

	GeometryIsSmall			= No

	BuildCompletion			= PLACED_BY_PLAYER
	
	GeometryContactPoint = X:0.0	Y:0.0		Z:0
	GeometryContactPoint = X:0.0	Y:0.0		Z:20.0		Swoop

	MaxSimultaneousOfType		= 1
	
End