;------------------------------------------------------------------------------
; Sauron
Object MordorSauron

    ; *** ART Parameters ***

    ; SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
    SelectPortrait = EMSauron

    ; ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
    ButtonImage = HISauron

    Draw = W3DScriptedModelDraw ModuleTag_01

        OkToChangeModelColor = No

        StaticModelLODMode = yes        ; Will append M or L to the skin name depending on GameLOD

;;====================== MODELS =============================================

    ;RandomTexture    = EX_FireNew02.tga 0 MUSauron.tga

    ;I have many FX for the Mace, but it all merges, and what kind of brighter will be see...
    ;Now, 6 FX we have. Default we see: 'FX' and'FX_2' and 'FX_3'
    ;FX_4 for some kind of special power
    ;FX_5 or FX_6 super FX and will be for greatest powers.

        DefaultModelConditionState
            Model = MUSauron_SKN
            ParticleSysBone = WEAPON SaronRingSpark FollowBone:Yes
        ParticleSysBone = FX SauronMaceFX   FollowBone:yes    
        ParticleSysBone = FX SauronMaceFX_2 FollowBone:yes  
        ParticleSysBone = FX SauronMaceFX_3 FollowBone:yes
        ParticleSysBone = SAURON SauronBodyFX FollowBone:yes
            ;ParticleSysBone = SAURON BalrogManeFlare FollowBone:yes
            ;ParticleSysBone = SAURON BalrogManeEmbers FollowBone:yes
            ;ParticleSysBone = SAURON BalrogManeFire FollowBone:yes
            ;ParticleSysBone = SAURON BalrogIgniteHeatWave FollowBone:yes

        
        End

	ModelConditionState = USER_5
			ParticleSysBone = NONE NazgulsAuraFlare2 FollowBone:Yes
	End


;;================== ANIMATIONS =================================================================

;;------------------ MOVING & DYING ---------------------------

;;======= DYING

    AnimationState                        = DYING
        Animation                        = DIEB
            AnimationName                = MUSauron_SKL.MUSauron_DIEB
            AnimationMode                = ONCE
        End
        
            
            ParticleSysBone = NONE UltraInitial01
            ParticleSysBone = NONE UltraInitial02
            ParticleSysBone = NONE UltraInitial03
        
        BeginScript
            CurDrawableShowSubObject("SHARD01")
            CurDrawableShowSubObject("SHARD02")
            CurDrawableShowSubObject("SHARD03")
            CurDrawableShowSubObject("SHARD04")
            CurDrawableShowSubObject("SHARD05")
            CurDrawableShowSubObject("SHARD06")
            CurDrawableShowSubObject("SHARD07")
            CurDrawableShowSubObject("SHARD08")
            CurDrawableShowSubObject("SHARD09")
            CurDrawableShowSubObject("SHARD10")
            CurDrawableShowSubObject("SHARD11")
            CurDrawableShowSubObject("SHARD12")
            CurDrawableShowSubObject("SHARD13")
            CurDrawableShowSubObject("SHARD14")
            CurDrawableShowSubObject("SHARD15")
            CurDrawableShowSubObject("SHARD16")
            CurDrawableShowSubObject("SHARD17")
            CurDrawableShowSubObject("SHARD18")
            CurDrawableShowSubObject("SHARD19")
            CurDrawableShowSubObject("SHARD20")
        EndScript
    End
        
    AnimationState                        = PARALYZED
        Animation
            AnimationName                = MUSauron_SKL.MUSauron_IDLA
            AnimationMode                = LOOP
        End
    End

;;======= MOVING

    AnimationState                        = MOVING FIRING_OR_PREATTACK_A
        StateName                        = STATE_Moving
        Animation                        = Moving
            AnimationName                = MUSauron_SKL.MUSauron_WLKB
            AnimationMode                = LOOP
            Distance                    = 88
        End
        Flags                            = MAINTAIN_FRAME_ACROSS_STATES
    End

    AnimationState                        = MOVING TURN_RIGHT_HIGH_SPEED
        StateName                        = STATE_Moving
        Animation                        = Moving
            AnimationName                = MUSauron_SKL.MUSauron_WLKA
            AnimationMode                = LOOP
            Distance                    = 88
        End
        Animation                        = Turning
            AnimationName                = MUSauron_SKL.MUSauron_TRNR
            AnimationMode                = LOOP
            AnimationBlendTime            = 0
        End
        Flags                            = MAINTAIN_FRAME_ACROSS_STATES MAINTAIN_FRAME_ACROSS_STATES2
        BeginScript
            if CurDrawablePrevAnimationState() == "STATE_Turning" then return "Turning" else return "Moving" end
        EndScript
    End
    
    AnimationState                        = MOVING TURN_LEFT_HIGH_SPEED
        StateName                        = STATE_Moving
        Animation                        = Moving
            AnimationName                = MUSauron_SKL.MUSauron_WLKA
            AnimationMode                = LOOP
            Distance                    = 88
        End
        Animation                        = Turning
            AnimationName                = MUSauron_SKL.MUSauron_TRNL
            AnimationMode                = LOOP
            AnimationBlendTime            = 0
        End
        Flags                            = MAINTAIN_FRAME_ACROSS_STATES MAINTAIN_FRAME_ACROSS_STATES2
        BeginScript
            if CurDrawablePrevAnimationState() == "STATE_Turning" then return "Turning" else return "Moving" end
        EndScript
    End

    AnimationState                        = TURN_LEFT
        StateName                        = STATE_Turning
        Animation                        = Turning
            AnimationName                = MUSauron_SKL.MUSauron_TRNL
            AnimationMode                = LOOP
            AnimationBlendTime            = 5
        End
        Flags                            = MAINTAIN_FRAME_ACROSS_STATES2
    End
    
    AnimationState                        = TURN_RIGHT
        StateName                        = STATE_Turning
        Animation                        = Turning
            AnimationName                = MUSauron_SKL.MUSauron_TRNR
            AnimationMode                = LOOP
            AnimationBlendTime            = 5
        End
        Flags                            = MAINTAIN_FRAME_ACROSS_STATES2
   End

    AnimationState                        = MOVING
        StateName                        = STATE_Moving
        Animation                        = Moving
            AnimationName                = MUSauron_SKL.MUSauron_WLKA
            AnimationMode                = LOOP
            Distance                    = 88
        End
        Flags                            = MAINTAIN_FRAME_ACROSS_STATES
    End
 
 ;;------------------ ABILITIES  -------------------------------
     
    AnimationState                        = SPECIAL_WEAPON_ONE                    ; Fires of doom
        Animation
            AnimationName                = MUSauron_SKL.MUSauron_ATKD
            AnimationMode                = ONCE
        End
        ParticleSysBone = NONE UltraInitial01
              ParticleSysBone = NONE UltraInitial02
               ParticleSysBone = NONE UltraInitial03
    End

    AnimationState            = SPECIAL_WEAPON_TWO                ; Black energy
            Animation
                AnimationName    = MUSauron_SKL.MUSauron_ATKD
                AnimationMode    = ONCE
            End
        ParticleSysBone = NONE SauronAuraPowers2_0
        ParticleSysBone = NONE SauronAuraPowers2_1
        ParticleSysBone = NONE SauronAuraPowers2_2    
    End

   AnimationState                        = SPECIAL_WEAPON_THREE
        Animation
            AnimationName                = MUSauron_SKL.MUSauron_ATKD
            AnimationMode                = ONCE
        End
        ParticleSysBone = NONE SauronSoulsEaterFX2
    End

 ;;------------------ ATTACKING  -------------------------------

    AnimationState                        = FIRING_OR_PREATTACK_A
        StateName                        = STATE_Ready
        Animation                        = ATKC
            AnimationName                = MUSauron_SKL.MUSauron_ATKC
            AnimationMode                = ONCE
            UseWeaponTiming                = Yes
        End
    ;Added / ÌÓ‚ÓÂ
    ;StateName                        = STATE_Ready    ;STATE_Moving
    ;    Animation                        = Moving
    ;            AnimationName                = MUSauron_SKL.MUSauron_WLKB
    ;        AnimationMode                = ONCE ;LOOP
    ;        ;Distance                    = 0
    ;        UseWeaponTiming                = Yes
    ;    End
    ;”‰‡ ÓÚ ÒÂ·ˇ
    StateName                        = STATE_Ready
        Animation                        = ATKA
            AnimationName                = MUSauron_SKL.MUSauron_ATKA
            AnimationMode                = ONCE
            UseWeaponTiming                = Yes
        End
    ; Animation                        = ATKA1
        ;    AnimationName                = MUSauron_SKL.MUSauron_ATKA1
        ;    AnimationMode                = ONCE
        ;    UseWeaponTiming                = Yes
        ;End
    ;Animation                        = ATKB1
        ;    AnimationName                = MUSauron_SKL.MUSauron_ATKB1
        ;    AnimationMode                = ONCE
        ;    UseWeaponTiming                = Yes
        ;End
    ;ÛÍË ‚‚Âı
    ;Animation                        = ATKD
        ;    AnimationName                = MUSauron_SKL.MUSauron_ATKD
        ;    AnimationMode                = ONCE
        ;    UseWeaponTiming                = Yes
        ;End
    ;Ì‡ÒÚÛÔ‡ÂÚ Ë ÛÍË ‚‚‚Âı
    ;Animation                        = ATKE
        ;    AnimationName                = MUSauron_SKL.MUSauron_ATKE
        ;    AnimationMode                = ONCE
        ;    UseWeaponTiming                = Yes
        ;End
    ;Animation                        = FLYA
        ;    AnimationName                = MUSauron_SKL.MUSauron_FLYA
        ;    AnimationMode                = ONCE
        ;    UseWeaponTiming                = Yes
        ;End
    End

;;-------------------- HIT REACTIONS --------------------------

    AnimationState                        = HIT_REACTION
        StateName                        = STATE_Ready
        Animation
            AnimationName                = MUSauron_SKL.MUSauron_HITA
            AnimationMode                = ONCE
        End
    End
        
        AnimationState        = RAISING_FLAG
            Animation
                AnimationName     = MUSauron_SKL.MUSauron_ATKC
                AnimationMode     = ONCE
            End
            Animation
                AnimationName     = MUSauron_SKL.MUSauron_ATKD
                AnimationMode     = ONCE
            End
            Animation
                AnimationName     = MUSauron_SKL.MUSauron_ATKE
                AnimationMode     = ONCE
            End
            Flags                    = RESTART_ANIM_WHEN_COMPLETE
        End

;;--------------- IDLE STATES ---------------------------------

    AnimationState                        = SELECTED
        StateName                        = Idle
        Animation                        = IDLA
            AnimationName                = MUSauron_SKL.MUSauron_IDLA
            AnimationMode                = LOOP
        End
    End

    IdleAnimationState
        AllowRepeatInRandomPick            = Yes
        StateName                        = Idle
        Animation                        = IDLA
            AnimationName                = MUSauron_SKL.MUSauron_IDLA
            AnimationMode                = ONCE
            AnimationPriority            = 20
        End
        Animation                        = IDLC
            AnimationName                = MUSauron_SKL.MUSauron_IDLC
            AnimationMode                = ONCE
            AnimationPriority            = 10
            AnimationBlendTime            = 10
            AnimationSpeedFactorRange    = 0.7 1.5
        End
        BeginScript
            Prevs = CurDrawablePrevAnimationState()
            Preva = CurDrawablePrevAnimation()
            if Prevs == "STATE_Moving"
            then
                CurDrawableSetTransitionAnimState("TRANS_SmoothToIdle")
            elseif Prevs == "STATE_Ready"
            then
                CurDrawableSetTransitionAnimState("TRANS_ReallySmoothToIdle")
            end
            if Preva == "IDLC"
            then
                CurDrawableSetTransitionAnimState("TRANS_ReallySmoothToIdle")
            end
        EndScript
    End
;;--------------------- TRANSITIONS ----------------------------------------------------

    TransitionState                    = TRANS_SmoothToIdle
        Animation                    = IDLA
            AnimationName            = MUSauron_SKL.MUSauron_IDLA
            AnimationMode            = ONCE
            AnimationBlendTime        = 5
        End
    End
    TransitionState                    = TRANS_ReallySmoothToIdle
        Animation                    = IDLA
            AnimationName            = MUSauron_SKL.MUSauron_IDLA
            AnimationMode            = ONCE
            AnimationBlendTime        = 10
        End
    End
    
;;---------------------------------------------------------------------------------------
  End
 
    #include "..\..\..\includes\StunDrawModuleMedium.inc"

	Draw = W3DLightDraw ModuleTag_DrawLight
		Ambient = R:255 G:0 B:0
		Diffuse = R:255 G:0 B:0
		Radius = 20
		Intensity = 100
		AttachToBoneInAnotherModule = SAURON
	End

    ; ***DESIGN parameters ***
    Side                = Mordor
    EditorSorting        = UNIT
    ThreatLevel            = SAURON_THREAT_LEVEL
    ThingClass            = CHARACTER_UNIT
    TransportSlotCount    = TRANSPORTSLOTCOUNT_HERO
    BuildCost            = SAURON_BUILDCOST_FEM
    BuildTime            = SAURON_BUILDTIME_FEM            
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS
    VisionRange            = 0
 ShroudClearingRange 	= 18000
    
    
    BountyValue            = SAURON_BOUNTY_VALUE
    RecruitText             = CONTROLBAR:SauronRecruit
    ReviveText            = CONTROLBAR:SauronRevive
    Hotkey                = CONTROLBAR:SauronHotkey
    DisplayName            = OBJECT:MordorSauron
    //DisplayMeleeDamage = SAURON_DAMAGE
    CrushableLevel        = 2                                ; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
    CrusherLevel        = 0                                ; What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
    CrushAllies            = yes
    RamPower            = 25
     CommandSet            = SauronNewMenu1CommandSet
    CommandPoints        = 0

    WeaponSet
        Conditions            = None 
        Weapon                = PRIMARY SauronMace
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = SauronArmor_FEM
        DamageFX        = NormalDamageFX
    End

	ThreatBreakdown sau_DetailedThreat
	AIKindOf = HERO
  	End
  
    ; *** AUTO-RESOLVE data ***
    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveBody        = AutoResolve_HeroBody

    ; *** AUDIO Parameters ***;

    VoiceAttack            = SauronVoiceAttackMS
    VoiceFear            = EVA:SauronHelpMe
    VoiceCreated        = EVA:SauronCreated
    VoiceCreated        = +SOUND:CampOrcCreateSauronGlobal
    VoiceFullyCreated     = EVA:SauronCreated
    VoiceFullyCreated    = +SOUND:CampOrcCreateSauronGlobal
    VoiceMove            = SauronVoiceMoveMS
    VoicePriority        = 94
    VoiceSelect            = SauronVoiceSelectMS
    VoiceGuard            = SauronVoiceMoveMS

	SoundAmbient					= BarrowWightAmbienceMS
    
    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip    = SauronVoiceMoveMS
        VoiceEnterUnitMordorMumakil            = SauronVoiceMoveMS
        VoiceEnterUnitSlaughterHouse        = SauronVoiceMoveMS
        VoiceGarrison                        = SauronVoiceMoveMS
        VoiceInitiateCaptureBuilding        = SauronVoiceMoveMS
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:SauronFootstep            Animation:MUSauron_SKL.MUSauron_ATKE    Frames:47
        AnimationSound = Sound:SauronFootstep            Animation:MUSauron_SKL.MUSauron_DIEB    Frames:29
        AnimationSound = Sound:BodyFallSoldier            Animation:MUSAURON_SKL.MUSAURON_LNDA     Frames:4 30
        AnimationSound = Sound:SauronFootstep            Animation:MUSAURON_SKL.MUSAURON_WLKA     Frames:8 26 44 62 80 98 
        AnimationSound = Sound:SauronFootstep            Animation:MUSAURON_SKL.MUSAURON_WLKB     Frames:25 44 64 84 
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    EvaEventDieOwner        = SauronDie            ;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths
                                                ;For deaths you can respawn from, use the DeathFX

    ; Warn the player when the enemy gets Sauron. Override the normal sighting event from StandardUnitEvaEvents.inc
    EvaEnemyObjectSightedEvent = EnemySauronSeen

    ClientUpdate = EvaAnnounceClientCreate ModuleTag_CreateAnnounce
        AnnouncementEventEnemy = EnemySauronSeen
        AnnouncementEventAlly = None
        AnnouncementEventOwner = None
        
        OnlyIfVisible = Yes                        ; Don't announce if hidden in the shroud
        CountAsFirstSightedAnnoucement = Yes    ; Don't re-annouce if going into shroud & back
        UseObjectsPosition = No                    ; Play from central Fortress, not at Sauron's position
        CreateFakeRadarEvent = Yes                ; Allow player to jump to Sauron after hearing annoucement
    End

    ; *** ENGINEERING Parameters ***
    RadarPriority        = UNIT
   KindOf                = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE PATH_THROUGH_INFANTRY SCARY HEAVY_MELEE_HITTER // SUPPORT //ARMY_OF_DEAD IGNORE_FOR_EVA_SPEECH_POSITION //THROWN_OBJECT
PathfindDiameter    = 40.0

 
    ; Note - Not a RespawnBody, as we do not want to put them back in the respawnable hero list when dead.
    Body = ActiveBody ModuleTag_Body
        MaxHealth = SAURON_HEALTH
    MaxHealthDamaged        = MAX_HEALTH_DAMAGED_SHADOW_AND_GHOST
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End
    
    Behavior = AnnounceBirthAndDeathBehavior ModuleTag_AnnounceBirthAndDeathBehavior
    End

    Behavior = AIUpdateInterface ModuleTag_AI
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        AILuaEventsList                = SauronFunctions
    End
  
    LocomotorSet
        Locomotor = BasicSauronLocomotor
        Condition = SET_NORMAL 
        Speed     = 35 //32
    End
 
    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 3333 ; level 1 (light  damage)  hit reaction animations in frames (5 per sec)
        HitReactionThreshold1 = 100.0   ; level 1 (light  damage) threshold trigger
    End
 
    Behavior = PhysicsBehavior ModuleTag_Physics
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_SlowDeath
        DeathTypes            = ALL 
        SinkDelay            = 7000 //5000
        SinkRate            = 10.0     ; in Dist/Sec - fast!
        DestructionDelay    = 7000 //1800
    FX    = INITIAL FX_SauronDeathInitial
        Weapon                = FINAL RingHeroDeathShockwave
    End
    ;----------------------------CHILL SOUL-----------------------------------------    
    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = SauronAuraDeath    
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End
  
    Behavior = SpecialPowerModule ModuleTag_SauronTerribleFury
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        TriggerFX                    = FX_FearBlast
    End

    Behavior = SpecialAbilityUpdate ModuleTag_SauronTerribleFuryUpdate  
        SpecialPowerTemplate        = SpecialAbilityScreech
        AwardXPForTriggering        = 0        
        TriggerSound                = SauronTerribleFury
        EffectRange                    = 200
        
        UnpackTime                    = 100
        PreparationTime                = 1
        PackTime                    = 100
    End

    Behavior = SquishCollide ModuleTag_Squish
    End

    ;------- WORD OF POWER (NOT_BLUE RING BLAST) SPELL --------------------------------------------------------------------------------
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
        SpecialPowerTemplate = SpecialAbilityWordOfPower
        TriggeredBy = Upgrade_ObjectLevel12 Upgrade_ObjectLevel15
    End
    Behavior = SpecialPowerModule ModuleTag_WordStarter       
        SpecialPowerTemplate      = SpecialAbilityWordOfPower
        UpdateModuleStartsAttack  = Yes
        StartsPaused                = Yes
        
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate   
        SpecialPowerTemplate    = SpecialAbilityWordOfPower
        WhichSpecialWeapon        = 1
        SkipContinue            = Yes
        //TriggerFX        = FX_BalrogSummoningFinish_For_Sauron_WOP
        UnpackTime              = 2700 
        PackTime                = 3000         //1    
        FreezeAfterTriggerDuration = 3500
        
        AwardXPForTriggering    = 0        
        StartAbilityRange        = 80.0
        
        SpecialWeapon            = WordOfPowerForSauron
    End

	//Behavior = ActivateModuleSpecialPower ModuleTag_ActivePartTwo
        //SpecialPowerTemplate        = SpecialAbilityWordOfPower
        //StartAbilityRange            = 5
        //TriggerSpecialPower            = ModuleTag_ChangePowersToRangePart1
    	///End

	//Behavior = SpecialPowerModule ModuleTag_ChangePowersToRangePart1   
	//	SpecialPowerTemplate      = SpecialAbilityWordOfPower
	//	UpdateModuleStartsAttack  = No
	//	StartsPaused = No
	//	AttributeModifier = AwardPowerFrom_2
	//	AttributeModifierAffectsSelf = Yes
	//	AttributeModifierAffects = ANY +HERO
	//End

    ;------- WORD OF POWER (NOT_BLUE RING BLAST) SPELL FOR AI --------------------------------------------------------------------------------
    ;Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler_FOR_AI
    ;    SpecialPowerTemplate = SpecialAbilityWordOfPower
    ;    TriggeredBy = Upgrade_ObjectLevel8
    ;End
    Behavior = SpecialPowerModule ModuleTag_WordStarter_FOR_AI    
        SpecialPowerTemplate      = SpecialAbilityWordOfPower_FOR_AI
        UpdateModuleStartsAttack  = Yes
        StartsPaused                = No
        
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate_FOR_AI   
        SpecialPowerTemplate    = SpecialAbilityWordOfPower_FOR_AI
        WhichSpecialWeapon        = 1
        SkipContinue            = Yes
        //TriggerFX        = FX_BalrogSummoningFinish_For_Sauron_WOP
        UnpackTime              = 2700 
        PackTime                = 3000         //1    
        FreezeAfterTriggerDuration = 3500
        
        AwardXPForTriggering    = 0        
        StartAbilityRange        = 80.0
        
        SpecialWeapon            = WordOfPowerForSauron
    End

    ;------------------FIRES OF DOOM------------------------------------------------------------------
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TeleportEnabler
        SpecialPowerTemplate = FiresOfDoomSpecialPower
        TriggeredBy             = Upgrade_ObjectLevel7 Upgrade_ObjectLevel15
    End
    Behavior = SpecialPowerModule ModuleTag_FiresOfDoom                   
        SpecialPowerTemplate        = FiresOfDoomSpecialPower
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound                = SauronVoxBlackspeechFiresOfDoom
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FiresOfDoomUpdate
        SpecialPowerTemplate    = FiresOfDoomSpecialPower
        WhichSpecialWeapon        = 1                            ; use MODELCONDITION_SPECIAL_WEAPON_ONE
        SkipContinue            = Yes

        UnpackTime              = 900
        PreparationTime         = 1   
        PersistentPrepTime      = 1500 
        PackTime                = 1100
        
        FreezeAfterTriggerDuration    = 500   //2500                 ; make sure we can't move immediately after.

        AwardXPForTriggering    = 0        
        StartAbilityRange        = 300.0
        MustFinishAbility        = Yes
        SpecialWeapon            = SauronFiresOfDoomWeapon
        ;TriggerSound            = SpellRainOfFireMS
    End

    
    ;------------------FIRES OF DOOM FOR AI------------------------------------------------------------------
    
    Behavior = SpecialPowerModule ModuleTag_FiresOfDoom_FOR_AI                 
        SpecialPowerTemplate        = FiresOfDoomSpecialPower_FOR_AI
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
        InitiateSound                = SauronVoxBlackspeechFiresOfDoom
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FiresOfDoomUpdate_FOR_AI
        SpecialPowerTemplate    = FiresOfDoomSpecialPower_FOR_AI
        WhichSpecialWeapon        = 1                            ; use MODELCONDITION_SPECIAL_WEAPON_ONE
        SkipContinue            = Yes

        UnpackTime              = 900
        PreparationTime         = 1   
        PersistentPrepTime      = 1500 
        PackTime                = 1100
        
        FreezeAfterTriggerDuration    = 500   //2500                 ; make sure we can't move immediately after.

        AwardXPForTriggering    = 0        
        StartAbilityRange        = 300.0
        MustFinishAbility        = Yes
        SpecialWeapon            = SauronFiresOfDoomWeapon
        ;TriggerSound            = SpellRainOfFireMS
    End
    
;-------------------------------------BLINK (Teleport) SPELL-----------------------------------------------------
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TeleportEnabler__
        SpecialPowerTemplate = SpecialAbilityBlink
        TriggeredBy             = Upgrade_ObjectLevel5 Upgrade_ObjectLevel15
    End

    Behavior = SpecialPowerModule ModuleTag_TeleportStarter__                      
        SpecialPowerTemplate     = SpecialAbilityBlink
        UpdateModuleStartsAttack = Yes
        TriggerFX        = FX_Blink_FOR_EVIL_MOD
        StartsPaused        = Yes
    End
    Behavior = TeleportSpecialAbilityUpdate ModuleTag_TeleportUpdate__   
        SpecialPowerTemplate  =    SpecialAbilityBlink
    
        //UnpackingVariation      =    1

        UnpackTime         =    1
        PreparationTime        =     1
        //PersistentPrepTime      5000
        PackTime        =    5000

        //StartAbilityRange        = 900.0

    
        ApproachRequiresLOS      =    Yes
        BusyForDuration          =    1 // don't accept    any    AI for this    long...    ai commands    will be    queued (should be at least PackTime)
        
        DestinationWeaponName =    blink_for_karsh    // Fires    at point of    teleport to    push people    away and down.
        SourceWeaponName            = FastTeleport
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehavior
        SpecialAbility                = SpecialAbilityBlink                    ; Use this ability
        StartsActive                = Yes                                            ; Active immediately.
        BaseMaxRangeFromStartPos    = Yes                                            ; Use the starting position rather than the current.
        AdjustAttackMeleePosition    = Yes                                            ; Offset attacking position away from large objects.
        MaxScanRange                = 50000                                        ; Target must be within this range.
        MinScanRange                = 1000                                            ; Target must be further away than this.
        AllowSelf                    = No
        IdleTimeSeconds                = 4
        Query                        = 10 ANY ENEMIES +STRUCTURE                                                ; Must be idle for this long to consider the ability, stops attacks being interrupted.
        Query                        = 7 ANY ENEMIES +INFANTRY +HERO
        Query                        = 4 ALL ENEMIES
        Query                        = 1 ANY ALLIES +STRUCTURE
    End


;;; WIZARD BLAST SPECIAL POWER ;;; ÚÂÎÂÍËÌÂÁ

    Behavior = SpecialPowerModule ModuleTag_WingBlastStarter
        SpecialPowerTemplate        = SpecialPowerTelekeneticPush
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No
        ;InitiateSound            = DrogothVoxWingBlast
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WingBlastUpdate
        SpecialPowerTemplate    = SpecialPowerTelekeneticPush
        UnpackTime              = 2000                                                ; time before the first flap
        PreparationTime            = 1                                                    ; *needs* to be something non-zero
        PackTime                = 1
        PersistentPrepTime        = 900                                                ; time between flaps, can't get much of a lower value than this.
        PersistentCount            = 20    ; Total timing: this * PersistentPrepTime            ; Change the anim speed to get a better match.
        AwardXPForTriggering    = 0
        StartAbilityRange        = 40000.0    ;please don't make this zero
                                        ;zero makes the AI that controls this power sad
        SpecialWeapon            = SauronTelekenesis_beta
        ;WhichSpecialWeapon        = 3                        ; sets SPECIAL_WEAPON_THREE
        ;SkipContinue            = Yes
    End
    
    
    ;End


;--------------------------------------------------À»ƒ≈–—“¬Œ ƒÀﬂ ¬Œ»ÕŒ¬
        Behavior = SpecialPowerModule ModuleTag_LeadershipNeededWork
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End
        Behavior = AttributeModifierAuraUpdate ModuleTag_FaramirLeadership
        StartsActive    = Yes
        BonusName        = GaladrielLeadership
        RefreshDelay    = 2500
        Range            = 500
       // AntiCategory    = BUFF
        ObjectFilter    = ALL -STRUCTURE -HERO
    End
    
//----------------------------------------------------------------------------------------
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_IstariLightPowerEnabler
        SpecialPowerTemplate = SpecialAbilityIstariLight
        TriggeredBy             = Upgrade_ObjectLevel7 Upgrade_ObjectLevel15
    End
Behavior = SpecialPowerModule ModuleTag_IstariLightPower                      
        SpecialPowerTemplate        = SpecialAbilityIstariLight
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = Yes
        End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IstariLightUpdate
        SpecialPowerTemplate    = SpecialAbilityIstariLight
        SkipContinue            = Yes
        UnpackTime              = 2000 
         PreparationTime         = 1  
         PersistentPrepTime      = 2000
         PackTime                = 500
        AwardXPForTriggering    = 0
        StartAbilityRange        = GANDALF_PHASER_CAST_RANGE ; Note: This has to be smaller than the weapon range or it'll never succeed
        ApproachRequiresLOS        = Yes        
        SpecialWeapon            = SauronStaffWeapon //GandalfStaffWeapon
        MustFinishAbility        = Yes
        //WhichSpecialWeapon        = 3
        BusyForDuration            = 2500
    End

    Behavior = SpecialPowerModule ModuleTag_IstariLightPower_FOR_AI                      
        SpecialPowerTemplate        = SpecialAbilityIstariLight_FOR_AI
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No
        End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IstariLightUpdate_FOR_AI
        SpecialPowerTemplate    = SpecialAbilityIstariLight_FOR_AI
        SkipContinue            = Yes
        UnpackTime              = 2000 
         PreparationTime         = 1  
         PersistentPrepTime      = 2000
         PackTime                = 500
        AwardXPForTriggering    = 0
        StartAbilityRange        = GANDALF_PHASER_CAST_RANGE ; Note: This has to be smaller than the weapon range or it'll never succeed
        ApproachRequiresLOS        = Yes        
        SpecialWeapon            = SauronStaffWeapon //GandalfStaffWeapon
        MustFinishAbility        = Yes
        //WhichSpecialWeapon        = 3
        BusyForDuration            = 2500
    End


//--------------------------------------------------------------------------    
// DISGUISE SPECIAL POWER //Œ¡Œ–Œ“≈Õ‹!
Behavior = StealthUpdate ModuleTag_CreateAHeroCMDisguiseStealthUpdate
        StealthDelay                            = 1
        DisguisesAsTeam                            = Yes
        RevealDistanceFromTarget                = 100.0f
        OrderIdleEnemiesToAttackMeUponReveal    = Yes
        //DisguiseFX                            = FX_BombTruckDisguise
        //DisguiseRevealFX                      = FX_BombTruckDisguiseReveal
        InnateStealth                            = Yes
        DisguiseTransitionTime                    = 4000 //2000
        DisguiseRevealTransitionTime            = 4000 //1000
        //RequiredUpgradeNames                    = Upgrade_CreateAHero_ClassCorruptedMan
    End

Behavior = SpecialPowerModule ModuleTag_CreateAHeroDisguiseStarter
    SpecialPowerTemplate        = SpecialAbilitySauronDisguise //for sauron only!
    UpdateModuleStartsAttack    = No
    StartsPaused                = No
    InitiateSound                = CaH_Disguise
End
Behavior = SpecialAbilityUpdate ModuleTag_CreateAHeroDisguiseUpdate
    SpecialPowerTemplate        = SpecialAbilitySauronDisguise //for sauron only!
    StartAbilityRange            = 1000000.0
    ApproachRequiresLOS            = No
End

///////////////////////////////////////////////////////////ÕÓ‚˚Â ÒÔÓÒÓ·ÌÓÒÚË//////////////////////////////////////////////

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HaunterSoulsEnabler
		SpecialPowerTemplate	= SpecialAbilityHaunterSouls
		TriggeredBy				= Upgrade_ObjectLevel14 Upgrade_ObjectLevel15
	End 
	
	Behavior = SpecialPowerModule ModuleTag_HaunterSoulsStarter                      
		SpecialPowerTemplate		= SpecialAbilityHaunterSouls
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
		;InitiateSound				= LurtzVoiceAttackCripplingStrike
	End
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_HaunterSoulsUpdate   
		SpecialPowerTemplate    = SpecialAbilityHaunterSouls
		SkipContinue			= Yes

		UnpackTime				= 1100	; Pull out arrow
		PreparationTime			= 1		; Quick shot
		PersistentPrepTime		= 500	; looping the quick shot
		PackTime				= 500	; back to idle
		MustFinishAbility		= Yes
		
		AwardXPForTriggering	= 500		
		StartAbilityRange		= 500
		
		ChainedButton            = Command_SauronSoulsHaunterFlingPassenger
		TriggerAttributeModifier    = SauronSoulEater	;SharkuManEater
        	AttributeModifierDuration    = 0		

		SpecialWeapon			= SauronSmiteThrown
		WhichSpecialWeapon		= 3
		;RejectedConditions		= WEAPON_TOGGLE
	End

	Behavior = PlayerHealSpecialPower ModuleTag_SpecialPowerModuleFlingPassengerStarter
        SpecialPowerTemplate        = SpecialAbilityHaunterSoulsDrop
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No
        HealAmount            = 1.0
        HealAsPercent            = Yes
        HealAffects            = HERO
        HealRadius            = 0.0
        HealFX                = FX_SpellHealUnitHealBuff
    End

	;;; TELEPATY SPECIAL POWER ;;;
 	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DominateEnabler
		SpecialPowerTemplate		= SpecialAbilityDominateEnemy_ForSAU
		TriggeredBy					= Upgrade_ObjectLevel11 Upgrade_ObjectLevel15
	End

	Behavior = SpecialPowerModule ModuleTag_DominateEnemySpecialPowerModule
		SpecialPowerTemplate		= SpecialAbilityDominateEnemy_ForSAU
		StartsPaused			= Yes
		UpdateModuleStartsAttack	= Yes
		;InitiateSound			= SarumanVoiceDominate
	End

 	Behavior = DominateEnemySpecialPower ModuleTag_DominateEnemySpecialPower
        SpecialPowerTemplate		= SpecialAbilityDominateEnemy_ForSAU 
		;UnpackingVariation			= 1
		StartAbilityRange			= 5000.0
		
		AttributeModifierAffects	= ALL -STRUCTURE -MOVE_ONLY ENEMIES NEUTRAL ALLIES

		DominateRadius				= 50
		DominatedFX					= FX_SarumanDominateTargets
		TriggerFX					= FX_SarumanDominateTrigger
		
		UnpackTime					= 2000
		PreparationTime				= 1   
		FreezeAfterTriggerDuration	= 2500 ; Hold AI for this long after we fire.		
    End
	InheritableModule
	Behavior = TemporarilyDefectUpdate ModuleTag_TemporarilyDefectUpdate2
	DefectDuration	  = 60000
	End
	End

//-------------------------------------------------------------------------------------------------------------------

Behavior = SpecialPowerModule ModuleTag_ShapeCaveBatStarter
 		SpecialPowerTemplate		= SpecialAbilityKarshToggleFace
 		UpdateModuleStartsAttack	= Yes
 		StartsPaused			= No
		TriggerFX 			=	FX_FellStrength
		;InitiateSound				= FellBeastVoiceMove
 	End
	Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_ShapeCaveBat
 		SpecialPowerTemplate    = SpecialAbilityKarshToggleFace
 		StartAbilityRange		= 50.0									; pretty small so we are forced to the right place.
 		MountedTemplate			= MordorSauronFly
 		SynchronizeTimerOnSpecialPower = SpecialAbilityKarshToggleFace SpellBookDarkness_ForSauron SpellBookFreezingRain_ForSauron SpellBookBalrogAlly_ForSauron SpellBookSummonShadeOfWolf_ForSauron SpellBookAwakenWyrm_ForSauron SpecialPowerSpawnTornado SpecialAbilityStoreObjectsForLevel3Teleport_SAU SpecialAbilityTeleportStoredObjects_SAU SpecialAbilitySauronEscape SpecialAbilityCreateAHeroWordOfPoultry_Level1 SpecialPowerTelekeneticHold SpecialAbilitySauronFirekines
 		UnpackTime              = 6000
 		PreparationTime         = 0  
 		;PersistentPrepTime      = 5000
 		PackTime                = 0
 		OpacityTarget			= 0.5	//ÌÂÔÓÁ‡˜ÌÓÒÚ¸										; How see-thru to be at peak of change
 		AwardXPForTriggering    = -200
 		IgnoreFacingCheck		= Yes
	End

;;; œŒƒœ»“€¬¿Õ»≈ ;;

	;Behavior = UnpauseSpecialPowerUpgrade ModuleTag_PowerSentEnabler
	;	SpecialPowerTemplate = SpecialAbilityGivePower
	;	TriggeredBy = Upgrade_ObjectLevel10 Upgrade_ObjectLevel15
	;End
	Behavior = SpecialPowerModule ModuleTag_PowerSent
		SpecialPowerTemplate      = SpecialAbilityGivePower
		UpdateModuleStartsAttack  = No
		StartsPaused = No //to fuck now
		//InitiateSound	= MorgomirVoiceModeDarkGlory
		AttributeModifier = AwardPowerFrom_2
		AttributeModifierAffectsSelf = Yes
		AttributeModifierAffects = NONE +MordorSauron_RingHero +MordorSauron
	End

	Behavior = ActivateModuleSpecialPower ModuleTag_ActivePartTwo
        SpecialPowerTemplate        = SpecialAbilityGivePower
        StartAbilityRange            = 50
        TriggerSpecialPower            = ModuleTag_PowerSentPart2 TARGETPOS
    	End                                                           

	Behavior = SpecialPowerModule ModuleTag_PowerSentPart2   
		SpecialPowerTemplate      = SpecialAbilityGivePower2
		UpdateModuleStartsAttack  = No
		StartsPaused = No
		//InitiateSound	= MorgomirVoiceModeDarkGlory
		AttributeModifier = AwardPowerFrom_
		;AttributeModifierRange = 3
		AttributeModifierAffectsSelf = No
		AttributeModifierAffects = ANY +HERO
		;AttributeModifierFX = FX_GenericLeadership60Lvl3
	End


   Behavior   = DarknessSpecialPower ModuleTag_Darkness
		SpecialPowerTemplate			= SpellBookDarkness_ForSauron
		AttributeModifier				= SpellBookDarkness
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO -HORDE -MordorBlackRider -DwarvenZerker -NoldorWarrior -GondorKnightsofDol -WildBabyDrake -IsengardFanatic ALLIES
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_DARKNESS_DURATION
		ChangeWeather					= CLOUDY
		AvailableAtStart				= Yes
	End
    
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SummonBalrogEnabler
        SpecialPowerTemplate = SpellBookBalrogAlly_ForSauron
        TriggeredBy = Upgrade_ObjectLevel11 Upgrade_ObjectLevel15
    End


Behavior = OCLSpecialPower ModuleTag_SummonBalrog
        SpecialPowerTemplate = SpellBookBalrogAlly_ForSauron
        OCL                  = OCL_BalrogSummoning
        CreateLocation       = CREATE_AT_LOCATION
        StartsPaused            = Yes
        SetModelCondition        = ModelConditionState:SPECIAL_WEAPON_TWO
        SetModelConditionTime    = 3.1
        End
 
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SummonShadeOfWolfEnabler
        SpecialPowerTemplate = SpellBookSummonShadeOfWolf_ForSauron
        TriggeredBy = Upgrade_ObjectLevel15
    End
    
    Behavior = OCLSpecialPower ModuleTag_SummonShadeOfWolf
        SpecialPowerTemplate = SpellBookSummonShadeOfWolf_ForSauron
        OCL                  = OCL_ShadeofWolfSummoning
        CreateLocation       = CREATE_AT_LOCATION
        StartsPaused            = Yes
        SetModelCondition        = ModelConditionState:SPECIAL_WEAPON_TWO
        SetModelConditionTime    = 3.1
        End
 
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AwakenWyrmEnabler
        SpecialPowerTemplate = SpellBookAwakenWyrm_ForSauron
        TriggeredBy = Upgrade_ObjectLevel9 Upgrade_ObjectLevel15
    End
    
    Behavior = OCLSpecialPower ModuleTag_AwakenWyrm
        SpecialPowerTemplate = SpellBookAwakenWyrm_ForSauron
        OCL                  = OCL_Wyrm
        TriggerFX             = FX_WrymSummonStart
        CreateLocation       = CREATE_AT_LOCATION
        StartsPaused            = Yes
        SetModelCondition        = ModelConditionState:SPECIAL_WEAPON_TWO
        SetModelConditionTime    = 3.1
        End


//--------------------------------------------------------------------------
//                “Œ–Õ¿ƒŒ
//--------------------------------------------------------------------------

Behavior = OCLSpecialPower    ModuleTag_OCLSpawnTornado
        SpecialPowerTemplate    = SpecialPowerSpawnTornado
        OCL                        = HellishTordanoSpawn
        CreateLocation            = CREATE_AT_LOCATION
        AvailableAtStart        = Yes
        SetModelCondition        = ModelConditionState:SPECIAL_WEAPON_TWO
        SetModelConditionTime    = 3.1
    End

    ; Spawn Tornado
//--------------------------------------------------------------------------
//--------------------------------------------------------------------------
//                œŒ–“¿À
//--------------------------------------------------------------------------

;“ÂÎÂÔÓÚËÛÂÚ(2-‡ˇ Ù‡Á‡)
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_StoreObjectsForLevel3Teleportr
    SpecialPowerTemplate = SpecialAbilityStoreObjectsForLevel3Teleport_SAU
    TriggeredBy = Upgrade_ObjectLevel7 Upgrade_ObjectLevel15
End

Behavior = SpecialPowerModule ModuleTag_StoreObjectsForLevel3Teleport
    SpecialPowerTemplate     = SpecialAbilityStoreObjectsForLevel3Teleport_SAU 
    StartsPaused             = Yes
    UpdateModuleStartsAttack = Yes
End
Behavior = StoreObjectsSpecialPower ModuleTag_StoreObjectsForLevel3TeleportUpdate
    SpecialPowerTemplate       = SpecialAbilityStoreObjectsForLevel3Teleport_SAU
    StartAbilityRange           = 1000000.0 // i.e. pretty large
    ApproachRequiresLOS           = Yes           // can do this without seeing the target    units.
    Radius                       = 100       // the radius that will capture units
    UnpackTime                   = 0
    PreparationTime               = 1     
    FreezeAfterTriggerDuration = 0           // Zero!
    ChainedButton               = "Command_EvilMod_TeleportStoredList"
    //TriggerFX                   = FX_CAHTeleport
End

//--------------------------------------------------------------------------    
//        œ≈–¬¿ﬂ ‘¿«¿
//--------------------------------------------------------------------------    

Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TeleportStoredObjects_2_ENABLE
    SpecialPowerTemplate = SpecialAbilityTeleportStoredObjects_SAU
    TriggeredBy = Upgrade_ObjectLevel7 Upgrade_ObjectLevel15
End


Behavior = SpecialPowerModule ModuleTag_TeleportStoredObjects_2
    SpecialPowerTemplate     = SpecialAbilityTeleportStoredObjects_SAU
    StartsPaused             = Yes
    UpdateModuleStartsAttack = Yes
End
Behavior = TeleportToCasterSpecialPower ModuleTag_TeleportStoredObjectsUpdate_2
    SpecialPowerTemplate       = SpecialAbilityTeleportStoredObjects_SAU
    UnpackingVariation           = 1
    StartAbilityRange           = 1000000.0 // i.e. pretty large
    Radius                       = 100       // the radius    that will capture units
    ApproachRequiresLOS           = Yes           // can do    this without seeing    the    target units.
    TargetFX                   = FX_CAHBlink
    TriggerFX                   = FX_CAHTeleport
    MinDestinationRadius       = 10           // the inner radius of the ring where    units will teleport    to
    MaxDestinationRadius       = 100       // the outer radius of the ring where    units will teleport    to
    UnpackTime                   = 1
    PreparationTime               = 1     
    FreezeAfterTriggerDuration = 2500       // Hold AI for this long after we    fire.        
End

////////////////////////////////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------------    
//                 «¿Ã≈Ÿ≈Õ»≈
//--------------------------------------------------------------------------    

Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordOfPoultry_Level1_Enable
    SpecialPowerTemplate = SpecialAbilityCreateAHeroWordOfPoultry_Level1
    TriggeredBy = Upgrade_ObjectLevel9 Upgrade_ObjectLevel15
End


Behavior = SpecialPowerModule ModuleTag_CreateAHeroWordOfPoultryStarter_Level1            // SpecialAbility is    a SpecialPower,    SpecialPower is    anyting    special
    SpecialPowerTemplate = SpecialAbilityCreateAHeroWordOfPoultry_Level1
    StartsPaused         = Yes
End

Behavior = ReplaceObjectUpdate ModuleTag_WordOfPoultryUpdate_Level1
    SpecialPowerTemplate    = SpecialAbilityCreateAHeroWordOfPoultry_Level1
    //SkipContinue            = Yes

    UnpackingVariation        = 1

    UnpackTime                 = 800
    PreparationTime            = 1   
    //PersistentPrepTime        = 1000 
    PackTime                = 100
    
    AwardXPForTriggering    = -100
    
    StartAbilityRange        = CREATE_A_HERO_WORD_OF_POULTRY_RANGE_L1
    MustFinishAbility        = Yes
    
    ReplaceObject
        TargetObjectFilter = ALL -LesserWight -BarrowWight -RohanOathbreakerHorde -RohanOathbreakerHordeSmall -AngmarKarsh -MordorSauron -MordorBalrog -MordorSauron_RingHero -AngmarWitchking -AngmarShadeWolf -ArnorCaptainStealthless -IsengardSaruman -STRUCTURE -HERO
        ReplacementObjectName = Chicken_Replacement Rabbit_Replacement Dog_Replacement Dog1_Replacement Racoon_Replacement Duck_Replacement Cow_Replacement Sheep_Replacement Crow_Replacement //GoatMale_Replacement GoatFemale_Replacement
    End
    ReplaceObject
        TargetObjectFilter = ANY +STRUCTURE -COMMANDCENTER
        ReplacementObjectName = DolGoldurStatue
    End
    ReplaceRadius            = CREATE_A_HERO_WORD_OF_POULTRY_RADIUS_L1
    ReplaceFX                = FX_CreateAHeroReplaceObject
    Scatter                    = Yes
End

;--------------Escape Ability
    Behavior = SpecialPowerModule ModuleTag_ElfCloakStarter
        SpecialPowerTemplate        = SpecialAbilitySauronEscape
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_ElfCloakUpdate   
        SpecialPowerTemplate    = SpecialAbilitySauronEscape
        EffectDuration        = 60000
        ShowPalantirTimer        = Yes
    End    
    
    Behavior = InvisibilityUpdate ModuleTag_StealthForEscape
        InvisibilityNugget
            InvisibilityType        = STEALTH
            ForbiddenConditions        = NONE ;USING_ABILITY
            BecomeStealthedFX        = FX_WormtongueEscapeOn
            ExitStealthFX            = FX_WormtongueEscapeOff
        End
        StartsActive                = No
        UpdatePeriod                = 100
    End

;-------------------------------------BLINK (Teleport) SPELL-----------------------------------------------------
    ;Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FastTeleportEnabler
    ;    SpecialPowerTemplate = SpecialAbilityFastTeleport
    ;    TriggeredBy             = Upgrade_Blink_FEM
    ;End

    Behavior = SpecialPowerModule ModuleTag_FastTeleportStarter                      
        SpecialPowerTemplate     = SpecialAbilityFastTeleport
        UpdateModuleStartsAttack = Yes
        TriggerFX        = FX_Fast_Blink_A
        StartsPaused        = No
    End
    Behavior = TeleportSpecialAbilityUpdate ModuleTag_FastTeleportUpdate
        SpecialPowerTemplate  =    SpecialAbilityFastTeleport
    
        //UnpackingVariation      =    1

        UnpackTime         =    1
        PreparationTime        =     1
        PackTime        =    1

        StartAbilityRange        = 900.0

    
        ApproachRequiresLOS      =    No
        BusyForDuration          =    1 
        
        DestinationWeaponName =    FastTeleport
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehaviorFastTeleport
        SpecialAbility                = SpecialAbilityFastTeleport                    ; Use this ability
        StartsActive                = Yes                                            ; Active immediately.
        BaseMaxRangeFromStartPos    = Yes                                            ; Use the starting position rather than the current.
        AdjustAttackMeleePosition    = Yes                                            ; Offset attacking position away from large objects.
        MaxScanRange                = 900                                    ; Target must be within this range.
        MinScanRange                = 50                                            ; Target must be further away than this.
        AllowSelf                    = No
        IdleTimeSeconds                = 4                                                ; Must be idle for this long to consider the ability, stops attacks being interrupted.
        Query                        = 2 ANY ENEMIES +HERO
        Query                        = 1 ALL ENEMIES
    End


    ;; TELEKINESIS HOLD ;;;    
    Behavior = SpecialPowerModule ModuleTag_TelekinesisHoldStarter                            
        SpecialPowerTemplate        = SpecialPowerTelekeneticHold
        UpdateModuleStartsAttack    = Yes
        InitiateSound            = SarumanVoiceAttackWizardBlast
    End    

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_TelekinesisHoldUpdate
        SpecialPowerTemplate        = SpecialPowerTelekeneticHold
        WhichSpecialWeapon            = 2 ;
        //SkipContinue                = Yes
        UnpackTime                    = 400
        PreparationTime                = 1   
        PersistentPrepTime        = 90                                                ; time between flaps, can't get much of a lower value than this.
        PersistentCount            = 20
        //PackTime                    = 100
        
        AwardXPForTriggering        = 0
        StartAbilityRange            = 180.0
        MustFinishAbility            = No
        SpecialWeapon                = SauronTelekinesisWeapon
    End

;////////////////////////////////////////////////œ»–Œ »Õ≈«//////////////////////////////////

    Behavior = SpecialPowerModule ModuleTag_UdunPower                      
        SpecialPowerTemplate        = SpecialAbilitySauronFirekines
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
        InitiateSound                = SarumanVoiceAttackCharge
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_UdunpowerUpdate
        SpecialPowerTemplate    = SpecialAbilitySauronFirekines
        SkipContinue            = Yes
        UnpackTime              = 750
         PreparationTime         = 1  
         PersistentPrepTime      = 1000
         PackTime                = 500
        AwardXPForTriggering    = 0
        StartAbilityRange        = 290; Note: This has to be smaller than the weapon range or it'll never succeed
        ApproachRequiresLOS        = Yes        
        SpecialWeapon            = SauronFirekinesWeapon
        MustFinishAbility        = No
        ;WhichSpecialWeapon        = 3
        BusyForDuration            = 1500
    End

;-----------------------------------------------------------------------------------------    
	Behavior = MonitorConditionUpdate MonitorConditionUpdateModuleTag
        ModelConditionFlags             = WEAPONSET_TOGGLE_1
        ModelConditionCommandSet         = SauronNewMenu2CommandSet
      End

    ;----------------------------------------------------------------------------------------------------



;///////////////////////////////////////////////////////////////////////////////////////////////////////////////

    ;Sauron powers very strong, but their need get up - AI can't did it, i'm sure...
    ;And this setting can use all power on initial level! 

    Behavior = CommandSetUpgrade ModuleTag_AI_Cheating_CommandSet
        TriggeredBy    = Upgrade_BrutalAIMultiPlayer Upgrade_HardAIMultiPlayer Upgrade_MediumAIMultiPlayer Upgrade_EasyAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_HardAISinglePlayer Upgrade_MediumAISinglePlayer
        CommandSet    = SAU_PowersForAI_CommandSet
    End


;///////////////////////////////////////////////////////////////////////////////////////////////////////////////

    

    
    Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
        StartsActive    = Yes                                        ;If no, requires upgrade to turn on.
        BonusName        = SauronFear
        RefreshDelay    = 5000
        Range            = 250.0
        ObjectFilter    = ANY +INFANTRY +CAVALRY
        TargetEnemy        = Yes
        MaxActiveRank    = 3                                            ;Only affects level 1 rank units
    End        

    ;----------------------------------------------------------------------------------------------------

    Behavior = AutoAbilityBehavior ModuleTag_FiresOfDoomAutoAbility
        SpecialAbility    = FiresOfDoomSpecialPower
        Query            = 10 ANY ENEMIES +INFANTRY +CAVALRY                ; try a group of guys
        Query            = 1 ALL ENEMIES                                    ; then anything
    End

    Behavior = AutoHealBehavior ModuleTag_AutoHeal
        StartsActive            = Yes
        HealingAmount            = HERO_HEAL_AMOUNT
        HealingDelay            = 1000
        StartHealingDelay        = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat    = Yes
    End
    

    ;///////////////////
    ; AISpecialPowers
    ;///////////////////
    
    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

 //   Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
 //       CommandButtonName = Command_SetStanceAggressive
 //       SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
 //   End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate SauronWordOfPowerAI
        CommandButtonName = Command_WordOfPowerForSauron_AI
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER                ;AI_SPECIAL_POWER_BASIC_SELF_BUFF
        SpecialPowerRadius = 700
        SpecialPowerRange = 1500        ;˝ÚÓ ÁÌ‡˜ÂÌËÂ = ÏËÌËÏ‡Î¸Ì‡ˇ Û„ÓÁ‡, ‰Îˇ ËÒÔ. ÒÔÓÒÓ·ÌÓÒÚË.
    ;›ÚÓ ÔÓ‚˚ÒËÚ  œƒ ˝ÚÓÈ ÒÔÓÒÓ·ÌÓÒÚË, Ú.Í ÔÓÔÓÒÚÛ Â∏ ËÒÔÓÎ¸ÁÓ‚‡Ú¸ „ÎÛÔÓ, ‡ »» ÚÓÎ¸ÍÓ Ú‡Í Ë ËÒÔÓÎ¸ÁÛÂÚ.
    End

    Behavior = AISpecialPowerUpdate SauronSauronFiresOfDoomAI
        CommandButtonName = Command_FiresOfDoom_AI
        SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
        SpecialPowerRadius = 300.0
    End
    
    Behavior = AISpecialPowerUpdate SauronTerribleFuryAI
        CommandButtonName = Command_SpecialAbilitySAUTerribleFury
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate SauronLightningSwordAI
        CommandButtonName = Command_SauronIstariLight_AI
        SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
        SpecialPowerRadius = 100
    End

    
   Behavior = AISpecialPowerUpdate SauronSpellBookDarknessAI
        CommandButtonName = Command_SpellBookDarkness_ForSauron
        SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate SauronSpellBookShadeOfWolfAI
        CommandButtonName = Command_SpellBookSummonShadeOfWolf_ForSauron
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate SauronSpellBookAwakenWyrmAI
        CommandButtonName = Command_SpellBookAwakenWyrm_ForSauron
        SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER_PREF_WALLS
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate SauronSpellBookFreezingRainAI
        CommandButtonName = Command_SpellBookFreezingRain_ForSauron
        SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate SauronSpellBookBalrogAllyAI
        CommandButtonName = Command_SpellBookBalrogAlly_ForSauron
        SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate SauronSpawnTornadoAI
        CommandButtonName = Command_SpecialPowerSpawnTornado_ForSauron
        SpecialPowerAIType = AI_SPECIAL_POWER_TARGETAOE_SUMMON
        SpecialPowerRadius = 30.0
    End
    
    Behavior = AISpecialPowerUpdate SauronWordOfPoultryAI
    CommandButtonName = Command_SAURON_WordOfPoultry
    SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
    End

    Behavior = AISpecialPowerUpdate SauronTeleportAI
        CommandButtonName = Command_Blink
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 15000
        ;RandomizeTargetLocation = Yes
    End

     Behavior = AISpecialPowerUpdate SauronStealthsAI
        CommandButtonName = Command_SpecialAbilitySauronEscape
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End


    Geometry            = CYLINDER
    GeometryMajorRadius = 11
    GeometryHeight        = 32
    
    GeometryIsSmall        = Yes
    
    Shadow                = SHADOW_DECAL
    ShadowSizeX            = 22
    ShadowSizeY            = 22
    ShadowTexture        = ShadowI
End

;----------------------------------------------------

ChildObject MordorSauron_RingHero MordorSauron

    ; Player no longer has the ring hero upgrade when the hero is created.
    Behavior = RemoveUpgradeUpgrade ModuleTag_RemoveRing
        TriggeredBy                    = Upgrade_WildFaction Upgrade_IsengardFaction Upgrade_MordorFaction Upgrade_GoblinFaction Upgrade_AngmarFaction
        UpgradeToRemove                = Upgrade_RingHero Upgrade_FortressRingHero
        RemoveFromAllPlayerObjects    = Yes
        SuppressEvaEventForRemoval    = Yes ; Hack -- this is to avoid the Eva event about 'Gollum stole our ring'
                                         ; when we are actually losing the upgrade because we built the ring hero
    End

    ; Spawn a dropped ring object.
    Behavior = CreateObjectDie ModuleTag_DropTheRing
        CreationList = OCL_TheOneRing
    End

	Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
		LevelToGrant	= 7
		MPOnly		= No
	End 

	;ÔÓÒÚÓ ÌÂ ÌÛÊÌ˚ ˝ÚË 13 Ó·ÌÓ‚ÎÂÌËÈ, ÂÒÎË Ëı Á‡ÏÂÌËÚ¸ Ó‰ÌËÏ "Upgrade_ObjectLevel15"
	;‰Îˇ ‚ÂÌÓÈ ‡·ÓÚ˚ ÌÂÎ¸Áˇ Û‰‡ÎˇÚ¸ ÔˇÚ˚È ÛÓ‚ÂÌ¸ Ë ‚ CB.ini Á‡ÏÂÌËÚ¸ ÌÛÊÌ˚Â ÛÒ. 

	; Behavior = RemoveUpgradeUpgrade ModuleTag_RemoveAllUpgradesBeforeFinishLevel
        ;TriggeredBy                    = Upgrade_ObjectLevel15
        ;UpgradeToRemove                = Upgrade_ObjectLevel2 Upgrade_ObjectLevel3 Upgrade_ObjectLevel4 Upgrade_ObjectLevel5 Upgrade_ObjectLevel6 Upgrade_ObjectLevel7 Upgrade_ObjectLevel8 Upgrade_ObjectLevel9 Upgrade_ObjectLevel10 Upgrade_ObjectLevel11 Upgrade_ObjectLevel12 Upgrade_ObjectLevel13 Upgrade_ObjectLevel14
        ;RemoveFromAllPlayerObjects    = No
	;SuppressEvaEventForRemoval    = No
      	;End 

End

Object MordorSauronFly 
	;// *** ART Parameters ***

    ;// ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
    ButtonImage			= HICaveBats
    SelectPortrait		= UPBatCloud    

	Draw = W3DHordeModelDraw ModuleTag_01
		;// OkToChangeModelColor = Yes ; temporarily commented out to remove the house color

		WadingParticleSys = EntRipples

		StaticModelLODMode = Yes ; Will append M or L to the skin name depending on GameLOD

		DefaultModelConditionState
			Model					= Bats_SKN
		End
		
		IdleAnimationState
			StateName				= Idle
			Animation				= IdleA
				AnimationName       = Bats_SKL.Bats_IDLA
				AnimationMode       = LOOP
				AnimationBlendTime  = 30
			End
			Flags					= RANDOMSTART
		End
		
		;TransitionState       = TRANS_TO_IDLE
		;	Animation
		;		AnimationName     = Bats_IDLA
		;		AnimationMode     = ONCE
		;	End
		;End
		
	
		AnimationState				= JUST_BUILT
			StateName				= State_JustBuilt
			Animation
				AnimationName		= Bats_SKL.Bats_SMNA
				AnimationMode		= ONCE
				AnimationBlendTime	= 0
			End
		End
		
		AnimationState				= DYING DEATH_1				; Killed
			Animation
				AnimationName		= Bats_SKL.Bats_SMNB 
				AnimationMode		= ONCE
				AnimationBlendTime	= 15
			End
		End
		
		AnimationState				= MOVING
			Animation				= RunA
				AnimationName       = Bats_SKLBats_SMNABats_MOV
				AnimationMode       = LOOP
				AnimationBlendTime  = 30
;				Distance			= 35
			End
		End

		;AnimationState				=	SELECTED
		;	StateName				=	State_Selected
		;	Animation				=	AtAttention
		;		AnimationName		=	Bats_SKL.Bats_IDLA
		;		AnimationMode		=	LOOP
		;		AnimationBlendTime  =	30
		;	End
		;End
	End
	
	

	;// ***DESIGN parameters ***
	Side				= Mordor
	EditorSorting		= UNIT
	ThreatLevel			= 0.0
	CommandPoints		= 0
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_IMMUNE

	VisionRange			= 200.0
	DisplayName			= OBJECT:BatCloud
	
	CommandSet		= SauronflyCommandSet

	;// *** AUDIO Parameters ***
	EvaEnemyObjectSightedEvent	= None  ;// Don't bother player about this object showing up over their base -- happens too much to bother

	;SoundAmbient = CrebainAmbientLoop
	;SoundMoveStart = CrebainSelect

	;VoiceSelect = CrebainSelect

	;// *** ENGINEERING Parameters ***
	RadarPriority = UNIT
	KindOf = SELECTABLE NO_COLLIDE MONSTER MOVE_ONLY CLICK_THROUGH HERO IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION IGNORES_SELECT_ALL
		
	
	Body = ActiveBody ModuleTag_Body
        	MaxHealth = SAURON_HEALTH
		MaxHealthDamaged  = 1000	
	End

	Behavior = AIUpdateInterface	ModuleTag_AIUpdateInterface
	End

	Behavior = PhysicsBehavior		ModuleTag_PhysicsBehavior
	End
	
	Behavior = SlowDeathBehavior ModuleTag_NormalDeath			; Nuked
		DeathTypes			= ALL
        DeathFlags			= DEATH_1
		DestructionDelay	= 2000
		SinkDelay			= 2000
		;SinkRate			= 0.64								; in Dist/Sec
		Sound = INITIAL SpellGenericUnsummonFasterMS
	End
	
	; Detects other stealth units
	Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
		DetectionRate		= 500   ; how often to rescan for stealthed things in my sight (msec)
	End

	Behavior = SpecialPowerModule ModuleTag_ShapeCaveBatStarter
 		SpecialPowerTemplate		= SpecialAbilityKarshToggleFace
 		UpdateModuleStartsAttack	= Yes
 		StartsPaused			= No
		TriggerFX 			=	FX_FellStrength
		;InitiateSound				= FellBeastVoiceMove
 	End
	Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_ShapeCaveBat
 		SpecialPowerTemplate    = SpecialAbilityKarshToggleFace
 		StartAbilityRange		= 50.0									; pretty small so we are forced to the right place.
 		MountedTemplate			= MordorSauron_RingHero
 		SynchronizeTimerOnSpecialPower = SpecialAbilityKarshToggleFace SpellBookDarkness_ForSauron SpellBookFreezingRain_ForSauron SpellBookBalrogAlly_ForSauron SpellBookSummonShadeOfWolf_ForSauron SpellBookAwakenWyrm_ForSauron SpecialPowerSpawnTornado SpecialAbilityStoreObjectsForLevel3Teleport_SAU SpecialAbilityTeleportStoredObjects_SAU SpecialAbilitySauronEscape SpecialAbilityCreateAHeroWordOfPoultry_Level1 SpecialPowerTelekeneticHold SpecialAbilitySauronFirekines
 		UnpackTime              = 6000
 		PreparationTime         = 0  
 		;PersistentPrepTime      = 5000
 		PackTime                = 0
 		OpacityTarget			= 0.5	//ÌÂÔÓÁ‡˜ÌÓÒÚ¸										; How see-thru to be at peak of change
 		//AwardXPForTriggering    = -200
 		IgnoreFacingCheck		= Yes
	End	
	
	LocomotorSet
		Locomotor = CrebainLocomotor
		Condition = SET_NORMAL 
		Speed     = 200
	End
		
	Behavior = FireWeaponUpdate ModuleTag_PeckTheirEyesOut
		FireWeaponNugget
			WeaponName		= WildFortressBatCloudBasicWeapon
			FireDelay		= 1000
			OneShot			= No
		End
	End

	;Behavior = SlowDeathBehavior ModuleTag_05
	;	DeathTypes = ALL
	;End

	Geometry			= CYLINDER
	GeometryMajorRadius = 50.0
	GeometryHeight		= 61.0
	GeometryIsSmall		= No
	;AttackContactPoint  = X:0 Y:0 Z:60
	AttackContactPoint  = X:40 Y:40 Z:60
	AttackContactPoint  = X:-40 Y:40 Z:60
	AttackContactPoint  = X:-40 Y:-40 Z:60
	AttackContactPoint  = X:40 Y:-40 Z:60

    Shadow			= SHADOW_ADDITIVE_DECAL_DYNAMIC
    ShadowSizeX		= 400
    ShadowSizeY		= 400
    ShadowTexture	= MUSauronEye

	ShadowOpacityStart			= 0
	ShadowOpacityFadeInTime		= 1000
	ShadowOpacityPeak			= 255
	ShadowOpacityFadeOutTime	= 1000
	ShadowOpacityEnd			= 0

	ShadowOverrideLODVisibility = yes
End